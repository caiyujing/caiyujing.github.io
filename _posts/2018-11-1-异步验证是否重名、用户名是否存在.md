---
layout:     post
title:      å¼‚æ­¥éªŒè¯æ˜¯å¦é‡åã€ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
subtitle:   éªŒè¯æ˜¯å¦é‡åã€ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
date:       2018-11-1
author:     LY
header-img: img/post-bg-debug.png
catalog: true
tags:
    - java
    - å¼‚æ­¥
    - ajax
    - éªŒè¯
---

> åœ¨è¿™é‡Œå°å°æ¨èä¸‹æˆ‘çš„ä¸ªäººåšå®¢
>
> csdnï¼š[é›·å›­çš„csdnåšå®¢](https://blog.csdn.net/leiyuan2580)
>
> ä¸ªäººåšå®¢ï¼š[é›·å›­çš„ä¸ªäººåšå®¢](https://imlcl.store)
>
> ç®€ä¹¦ï¼š[é›·å›­çš„ç®€ä¹¦](https://www.jianshu.com/u/016322e40e1f)

# å¼‚æ­¥éªŒè¯æ˜¯å¦é‡åã€ç”¨æˆ·åæ˜¯å¦å­˜åœ¨

#### é¦–å…ˆæ˜¯æ•°æ®åº“è®¾è®¡ï¼Œåœ¨è¿™é‡Œæˆ‘åªåšç®€å•çš„ç¤ºä¾‹

1.sqlè¯­å¥å¦‚ä¸‹ï¼š

```sql
CREATE TABLE `ä½ çš„æ•°æ®åº“å`.`user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(45) NOT NULL,
  `password` VARCHAR(45) NOT NULL,
  `create_date` VARCHAR(45),
  PRIMARY KEY (`id`));
```

2.è¡¨ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![userè¡¨ç»“æ„](https://ws2.sinaimg.cn/large/006tNbRwly1fwsc551urnj311c08wq6a.jpg)

#### ç„¶åå°±æ˜¯ç¼–å†™æˆ‘ä»¬çš„daoå±‚ä»£ç 

##### 1.jdbcæ¨¡å¼ä»£ç å¦‚ä¸‹ï¼š

```java
package test;
import java.sql.*;
// æ³¨æ„åœ¨æ­¤å¤„å¼•å…¥ä½ çš„Userç±»
public class UserDao {
    // JDBC é©±åŠ¨ååŠæ•°æ®åº“ URL
    static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";  
    static final String DB_URL = "jdbc:mysql://localhost:3306/ä½ çš„æ•°æ®åº“å";
    // æ•°æ®åº“çš„ç”¨æˆ·åä¸å¯†ç ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„è®¾ç½®
    static final String USER = "your_username";
    static final String PASS = "your_password";
    // éªŒè¯ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
    public User verifyUser(String username){
        Connection conn = null;
        Statement stmt = null;
        User user = null;
        try{
            user = new User();
            // æ³¨å†Œ JDBC é©±åŠ¨
            Class.forName("com.mysql.jdbc.Driver");
            // æ‰“å¼€é“¾æ¥
            conn = DriverManager.getConnection(DB_URL,USER,PASS);
            // æ‰§è¡ŒæŸ¥è¯¢
            stmt = conn.createStatement();
            String sql;
            sql = "SELECT * FROM user where username = '"+ username +"'";
            ResultSet rs = stmt.executeQuery(sql);
            // å±•å¼€ç»“æœé›†æ•°æ®åº“
            while(rs.next()){
                // é€šè¿‡å­—æ®µæ£€ç´¢
                int id  = rs.getInt("id");
                String username1 = rs.getString("username");
                String password = rs.getString("password");
                String createDate = rs.getString("create_date");
                user.setId(id);
                user.setUsername(username1);
                user.setPassword(password);
                user.setCreateDate(createDate);
            }
            // å®Œæˆåå…³é—­
            rs.close();
            stmt.close();
            conn.close();
        }catch(SQLException se){
            // å¤„ç† JDBC é”™è¯¯
            se.printStackTrace();
        }catch(Exception e){
            // å¤„ç† Class.forName é”™è¯¯
            e.printStackTrace();
        }finally{
            // å…³é—­èµ„æº
            try{
                if(stmt!=null) stmt.close();
            }catch(SQLException se2){
            }// ä»€ä¹ˆéƒ½ä¸åš
            try{
                if(conn!=null) conn.close();
            }catch(SQLException se){
                se.printStackTrace();
            }
        }
        return user;
    }
}
```

##### 2.mybatisæ¨¡å¼å¦‚ä¸‹:

```java
// daoå±‚æ¥å£å¦‚ä¸‹
package dao;
import User;
import java.util.List;
public interface UserDao {
    // åˆ¤æ–­æ˜¯å¦é‡å
    User verifyUser(String username);
}
```

```xml
<!-- mappingæ–‡ä»¶å¦‚ä¸‹ -->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="UserDao" >
  <!--æŸ¥è¯¢Useræ˜¯å¦é‡å-->
  <select id="verifyUser" resultType="User">
      SELECT * FROM user where username = #{username};
  </select>
</mapper>
```

##### 3.hibernateæ¨¡å¼å¦‚ä¸‹:

```java
// daoå±‚æ¥å£
package dao;
import User;
import java.util.List;
public interface UserDao {
    //  æŸ¥è¯¢Useræ˜¯å¦é‡å
    User verifyUser(String username)ï¼›
}

```

```java
// daoå±‚å®ç°ç±»
package dao.impl;

import UserDao;
import User;
import org.apache.struts2.ServletActionContext;
import org.hibernate.Query;
import org.hibernate.ScrollableResults;
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;
import java.util.List;

@Repository
public class UserDaoImpl implements UserDao {

    @Autowired
    private SessionFactory sessionFactory;
    
    // æ ¹æ®ç”¨æˆ·ååˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨
    @Override
    @Transactional
    public User verifyUser(String username) {
        return (User) sessionFactory.getCurrentSession().createQuery("from User where username='" + username +"'").uniqueResult();
    }

}

```

#### æ¥ä¸‹æ¥ç¼–å†™æˆ‘ä»¬çš„service

<!--æ³¨æ„æ— è®ºç”¨ä»¥ä¸Šé‚£ç§æŒä¹…åŒ–æ–¹å¼å‡ä¸ä»¥ä¸‹serviceå®ç°åŸºæœ¬ç±»ä¼¼-->

```java
// UserServiceæ¥å£
package service;

import User;

public interface UserService {
    // æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ·
    String verifyUser(String username);
}
```

```java
// UserServiceImplå®ç°ç±»
package service.impl;

import User;
import service.UserService;

@Service
public class UserServiceImpl implements UserService {
    //  æ³¨å…¥userDao,å¦‚æœè¯•ç”¨jdbcçš„è¯ç›´æ¥åœ¨æ–¹æ³•å†…å¯¹UserDaoè¿›è¡Œå®ä¾‹åŒ–å³å¯
    @Autowired
    private UserDao userDao;
    
    // ä¸šåŠ¡é€»è¾‘å±‚å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œå¤„ç†
    public String verifyUser(String username){
        User user = userDao.verifyUser(username);
        // è¿™é‡Œä»£è¡¨å¦‚æœé€šè¿‡ç”¨æˆ·åæ²¡æœ‰æŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå³ä»£è¡¨æœªé‡åè¿”å›SUCCESSï¼Œå¦åˆ™è¿”å›ERRORä»£è¡¨ä»¥é‡å
        if(user == null){
            return "SUCCESS";
        }else{
            return "ERROR";
        }
    }
}
```

#### æ¥ä¸‹æ¥åˆ°äº†æˆ‘ä»¬çš„æ§åˆ¶å™¨å±‚Controller

```java
package controller;

import User;
import org.springframework.beans.factory.annotation.Autowired;
import service.UserService;
@Controller
@RequestMapping("/user")
public class UserController {
    @Autowired
    //  æ³¨å…¥userService
    private UserService userService;
   
    @ResponseBody
    @RequestMapping(value = "/verifyUser", method = RequestMethod.GET)
    public String verifyUser(@RequestParam("username") String username){
        return userService.verifyUser(username);
    }
}
```

#### æœ€åå°±æ˜¯æˆ‘ä»¬çš„é‡å¤´æˆäº†â€”â€”æˆ‘ä»¬çš„å‰ç«¯ä»£ç ä»¥åŠé€šè¿‡jqueryå®ç°ajaxå¼‚æ­¥éªŒè¯

1.jquery[æ€ä¹ˆå¯¼å…¥çœ‹æˆ‘å¦å¤–ä¸€ç¯‡åšå®¢](https://imlcl.store/2018/10/31/Ajax%E6%80%8E%E4%B9%88%E7%94%A8-%E5%BC%82%E6%AD%A5%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0/)

2.ç¼–å†™html

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>éªŒè¯æµ‹è¯•</title>
    <script src="http://code.jquery.com/jquery-1.4.1.min.js"></script>
</head>
<body>
<input type="text" name="username" id="username" onkeyup="verifyUser()"/>
<input type="text" name="password" id="password"/>
<script>
    function verifyUser() {
        $.ajax({
            type: "get",
            url:"/user/verifyUser",
            data:{
                username:$("#username").val()
            },
            success(data){
                if (data=="SUCCESS"){
                    alert("ç”¨æˆ·åå·²ç»å­˜åœ¨ï¼Œè¯·æ›´æ¢ï¼ï¼");
                } else {
                    // è¿™é‡Œåº”è¯¥ä¸åšååº”ï¼Œæˆ–æ˜¯ä¸ifè¿›è¡Œåå‘æ“ä½œ
                    alert("");
                }
            },
            error(){
                alert("ajaxé…ç½®æœ‰é”™ï¼Œè¯·æ£€æŸ¥urlä¸typeæ˜¯å¦æ­£ç¡®");
            }
        });
    }
</script>
</body>
</html>
```

#### ç»“æŸè¯­

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„éªŒè¯ç®—æ˜¯å®Œæˆï¼Œå¤§å®¶å¦‚æœè¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¯ä»¥è¯„è®ºæˆ–è€…ç•™è¨€å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½å…¨åŠ›ä¸ºå¤§å®¶è¿›è¡Œè§£ç­”ï¼Œè°¢è°¢å„ä½ğŸ™ğŸ™ğŸ™ğŸ™ã€‚